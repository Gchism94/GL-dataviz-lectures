<!DOCTYPE html>
<html lang="en"><head>
<link href="..//images/logo.png" rel="icon" type="image/png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.554">

  <meta name="author" content="Dr.&nbsp;Greg Chism">
  <title>INFO 526 - Time Series Visualizations</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<meta property="og:title" content="INFO 526 - Time Series Visualizations">
<meta property="og:description" content="INFO Data Visualization and Analysis - Week 4">
<meta property="og:site_name" content="INFO 526">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="minedata-bg.png" data-background-size="600px, cover" data-slide-number="none" class="quarto-title-block center">
  <h1 class="title">Time Series Visualizations</h1>
  <p class="subtitle">INFO Data Visualization and Analysis - Week 4</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Greg Chism 
</div>
        <p class="quarto-title-affiliation">
            UArizona School of Information
          </p>
    </div>
</div>

</section>
<section>
<section id="time-series-visualizations" class="title-slide slide level1 center">
<h1>Time Series Visualizations</h1>

</section>
<section id="setup" class="slide level2 smaller">
<h2>Setup</h2>
<div id="setup" class="cell" data-message="false" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a></a><span class="im">from</span> matplotlib.dates <span class="im">import</span> DateFormatter</span>
<span id="cb1-6"><a></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb1-7"><a></a><span class="im">from</span> janitor <span class="im">import</span> clean_names</span>
<span id="cb1-8"><a></a></span>
<span id="cb1-9"><a></a><span class="co"># Set the theme for seaborn</span></span>
<span id="cb1-10"><a></a>sns.set_theme(style<span class="op">=</span><span class="st">"white"</span>, palette<span class="op">=</span><span class="st">"colorblind"</span>)</span>
<span id="cb1-11"><a></a></span>
<span id="cb1-12"><a></a><span class="co"># Set figure parameters</span></span>
<span id="cb1-13"><a></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> [<span class="dv">8</span>, <span class="dv">8</span> <span class="op">*</span> <span class="fl">0.618</span>]</span>
<span id="cb1-14"><a></a>plt.rcParams[<span class="st">'figure.autolayout'</span>] <span class="op">=</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="working-with-dates" class="title-slide slide level1 center">
<h1>Working with dates</h1>

</section>
<section id="air-quality-index" class="slide level2">
<h2>Air Quality Index</h2>
<ul>
<li><p>The AQI is the Environmental Protection Agency’s index for reporting air quality</p></li>
<li><p>Higher values of AQI indicate worse air quality</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/aqi-levels.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>

<aside><div>
<p>Source: <a href="https://www.airnow.gov/aqi/aqi-basics/" class="uri">https://www.airnow.gov/aqi/aqi-basics/</a></p>
</div></aside></section>
<section id="aqi-levels" class="slide level2">
<h2>AQI levels</h2>
<p>The previous graphic in tabular form, to be used later…</p>
<div id="ee86a05d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a>aqi_levels <span class="op">=</span> pd.DataFrame({</span>
<span id="cb2-2"><a></a>    <span class="st">'aqi_min'</span>: [<span class="dv">0</span>, <span class="dv">51</span>, <span class="dv">101</span>, <span class="dv">151</span>, <span class="dv">201</span>, <span class="dv">301</span>],</span>
<span id="cb2-3"><a></a>    <span class="st">'aqi_max'</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>],</span>
<span id="cb2-4"><a></a>    <span class="st">'color'</span>: [<span class="st">"#D8EEDA"</span>, <span class="st">"#F1E7D4"</span>, <span class="st">"#F8E4D8"</span>, <span class="st">"#FEE2E1"</span>, <span class="st">"#F4E3F7"</span>, <span class="st">"#F9D0D4"</span>],</span>
<span id="cb2-5"><a></a>    <span class="st">'level'</span>: [<span class="st">"Good"</span>, <span class="st">"Moderate"</span>, <span class="st">"Unhealthy for sensitive groups"</span>, <span class="st">"Unhealthy"</span>, <span class="st">"Very unhealthy"</span>, <span class="st">"Hazardous"</span>]</span>
<span id="cb2-6"><a></a>})</span>
<span id="cb2-7"><a></a></span>
<span id="cb2-8"><a></a>aqi_levels[<span class="st">'aqi_mid'</span>] <span class="op">=</span> (aqi_levels[<span class="st">'aqi_min'</span>] <span class="op">+</span> aqi_levels[<span class="st">'aqi_max'</span>]) <span class="op">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aqi-data" class="slide level2">
<h2>AQI data</h2>
<ul>
<li><p>Source: <a href="https://www.epa.gov/outdoor-air-quality-data/air-data-daily-air-quality-tracker">EPA’s Daily Air Quality Tracker</a></p></li>
<li><p>2016 - 2022 AQI (Ozone and PM2.5 combined) for Tucson, AZ core-based statistical area (CBSA), one file per year</p></li>
<li><p>2016 - 2022 AQI (Ozone and PM2.5 combined) for San Francisco-Oakland-Hayward, CA CBSA, one file per year</p></li>
</ul>
</section>
<section id="tucson-az" class="slide level2 smaller">
<h2>2022 Tucson, AZ</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Read + head</a></li><li><a href="#tabset-1-2">Info</a></li><li><a href="#tabset-1-3">Describe</a></li><li><a href="#tabset-1-4">Missing values</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div id="7648f674" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a>tuc_2022 <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2022.csv"</span>)</span>
<span id="cb3-2"><a></a></span>
<span id="cb3-3"><a></a>tuc_2022 <span class="op">=</span> clean_names(tuc_2022).rename(columns<span class="op">=</span>{<span class="st">'_aqi_value'</span>: <span class="st">'aqi_value'</span>})</span>
<span id="cb3-4"><a></a></span>
<span id="cb3-5"><a></a>tuc_2022.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">aqi_value</th>
<th data-quarto-table-cell-role="th">main_pollutant</th>
<th data-quarto-table-cell-role="th">site_name</th>
<th data-quarto-table-cell-role="th">site_id</th>
<th data-quarto-table-cell-role="th">source</th>
<th data-quarto-table-cell-role="th">20_year_high_2000_2019_</th>
<th data-quarto-table-cell-role="th">20_year_low_2000_2019_</th>
<th data-quarto-table-cell-role="th">5_year_average_2015_2019_</th>
<th data-quarto-table-cell-role="th">date_of_20_year_high</th>
<th data-quarto-table-cell-role="th">date_of_20_year_low</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01/01/2022</td>
<td>40</td>
<td>PM2.5</td>
<td>GERONIMO</td>
<td>04-019-1113</td>
<td>AQS</td>
<td>115</td>
<td>35</td>
<td>62.2</td>
<td>01/01/2018</td>
<td>01/01/2001</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01/02/2022</td>
<td>55</td>
<td>PM2.5</td>
<td>GERONIMO</td>
<td>04-019-1113</td>
<td>AQS</td>
<td>57</td>
<td>31</td>
<td>43.2</td>
<td>01/02/2015</td>
<td>01/02/2016</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01/03/2022</td>
<td>55</td>
<td>PM2.5</td>
<td>GERONIMO</td>
<td>04-019-1113</td>
<td>AQS</td>
<td>67</td>
<td>29</td>
<td>43.6</td>
<td>01/03/2015</td>
<td>01/03/2005</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>01/04/2022</td>
<td>48</td>
<td>PM2.5</td>
<td>GERONIMO</td>
<td>04-019-1113</td>
<td>AQS</td>
<td>55</td>
<td>27</td>
<td>40.4</td>
<td>01/04/2015</td>
<td>01/04/2008</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01/05/2022</td>
<td>50</td>
<td>PM2.5</td>
<td>GERONIMO</td>
<td>04-019-1113</td>
<td>AQS</td>
<td>52</td>
<td>28</td>
<td>36.0</td>
<td>01/05/2013</td>
<td>01/05/2000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div id="5f768d3d" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a>tuc_2022.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 365 entries, 0 to 364
Data columns (total 11 columns):
 #   Column                     Non-Null Count  Dtype  
---  ------                     --------------  -----  
 0   date                       365 non-null    object 
 1   aqi_value                  365 non-null    int64  
 2   main_pollutant             365 non-null    object 
 3   site_name                  365 non-null    object 
 4   site_id                    365 non-null    object 
 5   source                     365 non-null    object 
 6   20_year_high_2000_2019_    365 non-null    int64  
 7   20_year_low_2000_2019_     365 non-null    int64  
 8   5_year_average_2015_2019_  365 non-null    float64
 9   date_of_20_year_high       365 non-null    object 
 10  date_of_20_year_low        365 non-null    object 
dtypes: float64(1), int64(3), object(7)
memory usage: 31.5+ KB</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3">
<div id="3873348c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a>tuc_2022.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">aqi_value</th>
<th data-quarto-table-cell-role="th">20_year_high_2000_2019_</th>
<th data-quarto-table-cell-role="th">20_year_low_2000_2019_</th>
<th data-quarto-table-cell-role="th">5_year_average_2015_2019_</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>365.000000</td>
<td>365.000000</td>
<td>365.000000</td>
<td>365.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>53.895890</td>
<td>83.432877</td>
<td>34.095890</td>
<td>49.835068</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>15.886967</td>
<td>27.515111</td>
<td>5.734905</td>
<td>10.732188</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>27.000000</td>
<td>44.000000</td>
<td>19.000000</td>
<td>33.800000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>44.000000</td>
<td>59.000000</td>
<td>31.000000</td>
<td>40.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>48.000000</td>
<td>77.000000</td>
<td>33.000000</td>
<td>47.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>61.000000</td>
<td>105.000000</td>
<td>38.000000</td>
<td>57.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>119.000000</td>
<td>161.000000</td>
<td>49.000000</td>
<td>82.400000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-4">
<div id="2f393778" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a>tuc_2022.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>date                         0
aqi_value                    0
main_pollutant               0
site_name                    0
site_id                      0
source                       0
20_year_high_2000_2019_      0
20_year_low_2000_2019_       0
5_year_average_2015_2019_    0
date_of_20_year_high         0
date_of_20_year_low          0
dtype: int64</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="first-look" class="slide level2 smaller">
<h2>First look</h2>
<div class="task">
<p>This plot looks quite bizarre. What might be going on?</p>
</div>
<div id="71f4336d" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a>sns.lineplot(data<span class="op">=</span>tuc_2022, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>)</span>
<span id="cb9-2"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-8-output-1.png" width="749" height="459"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transforming-date" class="slide level2 smaller">
<h2>Transforming date</h2>
<p>Using <code>pd.to_datetime()</code>:</p>
<div id="9ae9acb2" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a>tuc_2022[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(tuc_2022[<span class="st">'date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%m/</span><span class="sc">%d</span><span class="st">/%Y'</span>)</span>
<span id="cb10-2"><a></a></span>
<span id="cb10-3"><a></a><span class="bu">print</span>(tuc_2022.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 365 entries, 0 to 364
Data columns (total 11 columns):
 #   Column                     Non-Null Count  Dtype         
---  ------                     --------------  -----         
 0   date                       365 non-null    datetime64[ns]
 1   aqi_value                  365 non-null    int64         
 2   main_pollutant             365 non-null    object        
 3   site_name                  365 non-null    object        
 4   site_id                    365 non-null    object        
 5   source                     365 non-null    object        
 6   20_year_high_2000_2019_    365 non-null    int64         
 7   20_year_low_2000_2019_     365 non-null    int64         
 8   5_year_average_2015_2019_  365 non-null    float64       
 9   date_of_20_year_high       365 non-null    object        
 10  date_of_20_year_low        365 non-null    object        
dtypes: datetime64[ns](1), float64(1), int64(3), object(6)
memory usage: 31.5+ KB
None</code></pre>
</div>
</div>
</section>
<section id="investigating-aqi-values" class="slide level2">
<h2>Investigating AQI values</h2>
<ul>
<li>Take a peek at distinct values of AQI</li>
</ul>
<div id="7e7db106" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a><span class="co"># Check distinct values of aqi_value</span></span>
<span id="cb12-2"><a></a>distinct_aqi_values <span class="op">=</span> tuc_2022[<span class="st">'aqi_value'</span>].unique()</span>
<span id="cb12-3"><a></a><span class="bu">print</span>(distinct_aqi_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 40  55  48  50  45  42  41  38  37  43  44  35  46  52  49  58  64  51
  47  61  71  54  77  84  90  67  97 101  87 100  93  53  74  80 105 119
 108  94  31  39  34  59  32  28  27  33  36  60  81]</code></pre>
</div>
</div>
<ul>
<li><code>"."</code> likely indicates <code>NA</code>, and it’s causing the entire column to be read in as characters</li>
</ul>
</section>
<section id="rewind-and-start-over" class="slide level2 smaller">
<h2>Rewind, and start over</h2>
<div id="0c1df120" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a><span class="co"># Reload data with correct NA values</span></span>
<span id="cb14-2"><a></a>tuc_2022 <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2022.csv"</span>, na_values<span class="op">=</span>[<span class="st">"."</span>, <span class="st">""</span>])</span>
<span id="cb14-3"><a></a></span>
<span id="cb14-4"><a></a><span class="co"># Clean and transform data again</span></span>
<span id="cb14-5"><a></a>tuc_2022 <span class="op">=</span> clean_names(tuc_2022).rename(columns<span class="op">=</span>{<span class="st">'_aqi_value'</span>: <span class="st">'aqi_value'</span>})</span>
<span id="cb14-6"><a></a>tuc_2022[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(tuc_2022[<span class="st">'date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%m/</span><span class="sc">%d</span><span class="st">/%Y'</span>)</span>
<span id="cb14-7"><a></a></span>
<span id="cb14-8"><a></a><span class="co"># Check the structure of the data</span></span>
<span id="cb14-9"><a></a><span class="bu">print</span>(tuc_2022.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 365 entries, 0 to 364
Data columns (total 11 columns):
 #   Column                     Non-Null Count  Dtype         
---  ------                     --------------  -----         
 0   date                       365 non-null    datetime64[ns]
 1   aqi_value                  365 non-null    int64         
 2   main_pollutant             365 non-null    object        
 3   site_name                  365 non-null    object        
 4   site_id                    365 non-null    object        
 5   source                     365 non-null    object        
 6   20_year_high_2000_2019_    365 non-null    int64         
 7   20_year_low_2000_2019_     365 non-null    int64         
 8   5_year_average_2015_2019_  365 non-null    float64       
 9   date_of_20_year_high       365 non-null    object        
 10  date_of_20_year_low        365 non-null    object        
dtypes: datetime64[ns](1), float64(1), int64(3), object(6)
memory usage: 31.5+ KB
None</code></pre>
</div>
</div>
</section>
<section id="another-look" class="slide level2 smaller">
<h2>Another look</h2>
<div id="6d891dfe" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a>sns.lineplot(data<span class="op">=</span>tuc_2022, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>)</span>
<span id="cb16-2"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-12-output-1.png" width="751" height="459"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualizing-tucson-aqi" class="slide level2">
<h2>Visualizing Tucson AQI</h2>
<div id="5cebdc62" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-13-output-1.png" width="753" height="527"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="live-coding" class="slide level2 smaller">
<h2>Live coding</h2>
<div id="dae3e565" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Setup</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb17-4"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-5"><a></a><span class="im">from</span> matplotlib.dates <span class="im">import</span> DateFormatter</span>
<span id="cb17-6"><a></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb17-7"><a></a><span class="im">from</span> janitor <span class="im">import</span> clean_names</span>
<span id="cb17-8"><a></a></span>
<span id="cb17-9"><a></a><span class="co"># Set the theme for seaborn</span></span>
<span id="cb17-10"><a></a>sns.set_theme(style<span class="op">=</span><span class="st">"white"</span>, palette<span class="op">=</span><span class="st">"colorblind"</span>)</span>
<span id="cb17-11"><a></a></span>
<span id="cb17-12"><a></a><span class="co"># Set figure parameters</span></span>
<span id="cb17-13"><a></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> [<span class="dv">8</span>, <span class="dv">8</span> <span class="op">*</span> <span class="fl">0.618</span>]</span>
<span id="cb17-14"><a></a>plt.rcParams[<span class="st">'figure.autolayout'</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb17-15"><a></a>aqi_levels <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-16"><a></a>    <span class="st">'aqi_min'</span>: [<span class="dv">0</span>, <span class="dv">51</span>, <span class="dv">101</span>, <span class="dv">151</span>, <span class="dv">201</span>, <span class="dv">301</span>],</span>
<span id="cb17-17"><a></a>    <span class="st">'aqi_max'</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>],</span>
<span id="cb17-18"><a></a>    <span class="st">'color'</span>: [<span class="st">"#D8EEDA"</span>, <span class="st">"#F1E7D4"</span>, <span class="st">"#F8E4D8"</span>, <span class="st">"#FEE2E1"</span>, <span class="st">"#F4E3F7"</span>, <span class="st">"#F9D0D4"</span>],</span>
<span id="cb17-19"><a></a>    <span class="st">'level'</span>: [<span class="st">"Good"</span>, <span class="st">"Moderate"</span>, <span class="st">"Unhealthy for sensitive groups"</span>, <span class="st">"Unhealthy"</span>, <span class="st">"Very unhealthy"</span>, <span class="st">"Hazardous"</span>]</span>
<span id="cb17-20"><a></a>})</span>
<span id="cb17-21"><a></a></span>
<span id="cb17-22"><a></a>aqi_levels[<span class="st">'aqi_mid'</span>] <span class="op">=</span> (aqi_levels[<span class="st">'aqi_min'</span>] <span class="op">+</span> aqi_levels[<span class="st">'aqi_max'</span>]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb17-23"><a></a></span>
<span id="cb17-24"><a></a>tuc_2022 <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2022.csv"</span>, na_values<span class="op">=</span>[<span class="st">"."</span>, <span class="st">""</span>])</span>
<span id="cb17-25"><a></a></span>
<span id="cb17-26"><a></a>tuc_2022 <span class="op">=</span> clean_names(tuc_2022)</span>
<span id="cb17-27"><a></a>tuc_2022[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(tuc_2022[<span class="st">'date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%m/</span><span class="sc">%d</span><span class="st">/%Y'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Reveal below for code developed during live coding session.</p>
<div id="be7a83dd" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a><span class="co"># Plot background AQI levels</span></span>
<span id="cb18-2"><a></a><span class="cf">for</span> _, row <span class="kw">in</span> aqi_levels.iterrows():</span>
<span id="cb18-3"><a></a>    plt.axhspan(row[<span class="st">'aqi_min'</span>], row[<span class="st">'aqi_max'</span>], color<span class="op">=</span>row[<span class="st">'color'</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, lw<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb18-4"><a></a></span>
<span id="cb18-5"><a></a><span class="co"># Plot AQI values</span></span>
<span id="cb18-6"><a></a>sns.lineplot(data<span class="op">=</span>tuc_2022.dropna(subset<span class="op">=</span>[<span class="st">'aqi_value'</span>]), x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb18-7"><a></a></span>
<span id="cb18-8"><a></a><span class="co"># Annotate AQI levels</span></span>
<span id="cb18-9"><a></a><span class="cf">for</span> _, row <span class="kw">in</span> aqi_levels.iterrows():</span>
<span id="cb18-10"><a></a>    plt.text(pd.Timestamp(<span class="st">'2023-02-28'</span>), row[<span class="st">'aqi_mid'</span>], row[<span class="st">'level'</span>], ha<span class="op">=</span><span class="st">'right'</span>, size<span class="op">=</span><span class="dv">14</span>, color<span class="op">=</span><span class="st">'gray'</span>, weight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb18-11"><a></a></span>
<span id="cb18-12"><a></a><span class="co"># Additional annotations and formatting</span></span>
<span id="cb18-13"><a></a>plt.annotate(<span class="st">'2022'</span>, xy<span class="op">=</span>(pd.Timestamp(<span class="st">'2022-01-15'</span>), <span class="dv">5</span>), size<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb18-14"><a></a>plt.annotate(<span class="st">'2023'</span>, xy<span class="op">=</span>(pd.Timestamp(<span class="st">'2023-02-15'</span>), <span class="dv">5</span>), size<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb18-15"><a></a></span>
<span id="cb18-16"><a></a>plt.xlim(pd.Timestamp(<span class="st">'2022-01-01'</span>), pd.Timestamp(<span class="st">'2023-03-01'</span>))</span>
<span id="cb18-17"><a></a>plt.ylim(<span class="dv">0</span>, <span class="dv">400</span>)</span>
<span id="cb18-18"><a></a>plt.xlabel(<span class="va">None</span>)</span>
<span id="cb18-19"><a></a>plt.ylabel(<span class="st">'AQI'</span>)</span>
<span id="cb18-20"><a></a>plt.title(<span class="st">'Ozone and PM2.5 Daily AQI Values</span><span class="ch">\n</span><span class="st">Tucson, AZ'</span>)</span>
<span id="cb18-21"><a></a>plt.figtext(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="st">'Source: EPA Daily Air Quality Tracker'</span>, ha<span class="op">=</span><span class="st">'center'</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-22"><a></a>plt.gca().xaxis.set_major_formatter(DateFormatter(<span class="st">'%b'</span>))</span>
<span id="cb18-23"><a></a>plt.gca().xaxis.set_major_locator(mdates.MonthLocator())</span>
<span id="cb18-24"><a></a></span>
<span id="cb18-25"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section>
<section>
<section id="calculating-cumulatives" class="title-slide slide level1 center">
<h1>Calculating cumulatives</h1>

</section>
<section id="cumulatives-over-time" class="slide level2">
<h2>Cumulatives over time</h2>
<ul>
<li><p>When visualizing time series data, a somewhat common task is to calculate cumulatives over time and plot them</p></li>
<li><p>In our example we’ll calculate the number of days with “good” AQI (<span class="math inline">\(\le\)</span> 50) and plot that value on the y-axis and the date on the x-axis</p></li>
</ul>
</section>
<section id="calculating-cumulatives-1" class="slide level2">
<h2>Calculating cumulatives</h2>
<p>Step 1. Arrange your data</p>
<div id="246f6cfa" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a>tuc_2022 <span class="op">=</span> tuc_2022[[<span class="st">'date'</span>, <span class="st">'aqi_value'</span>]].dropna().sort_values(<span class="st">'date'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculating-cumulatives-2" class="slide level2">
<h2>Calculating cumulatives</h2>
<p>Step 2. Identify good days</p>
<div id="4cb3ed85" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a>tuc_2022[<span class="st">'good_aqi'</span>] <span class="op">=</span> np.where(tuc_2022[<span class="st">'aqi_value'</span>] <span class="op">&lt;=</span> <span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculating-cumulatives-3" class="slide level2">
<h2>Calculating cumulatives</h2>
<p>Step 3. Sum over time</p>
<div id="a1e29481" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a></a>tuc_2022[<span class="st">'cumsum_good_aqi'</span>] <span class="op">=</span> tuc_2022[<span class="st">'good_aqi'</span>].cumsum()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-cumulatives" class="slide level2 smaller">
<h2>Plotting cumulatives</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Plot</a></li><li><a href="#tabset-2-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div id="c49ae10f" class="cell" data-fig.asp="0.5" data-execution_count="18">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-19-output-1.png" width="749" height="527"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div id="9f241fe9" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a></a>sns.lineplot(data<span class="op">=</span>tuc_2022, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'cumsum_good_aqi'</span>)</span>
<span id="cb22-2"><a></a>plt.gca().xaxis.set_major_formatter(DateFormatter(<span class="st">"%b %Y"</span>))</span>
<span id="cb22-3"><a></a></span>
<span id="cb22-4"><a></a>plt.xlabel(<span class="va">None</span>)</span>
<span id="cb22-5"><a></a>plt.ylabel(<span class="st">"Number of days"</span>)</span>
<span id="cb22-6"><a></a>plt.title(<span class="st">"Cumulative number of good AQI days (AQI &lt; 50)</span><span class="ch">\n</span><span class="st">Tucson, AZ"</span>)</span>
<span id="cb22-7"><a></a>plt.figtext(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="st">'Source: EPA Daily Air Quality Tracker'</span>, ha<span class="op">=</span><span class="st">'center'</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb22-8"><a></a></span>
<span id="cb22-9"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="detrending" class="title-slide slide level1 center">
<h1>Detrending</h1>

</section>
<section id="detrending-1" class="slide level2">
<h2>Detrending</h2>
<ul>
<li><p>Detrending is removing prominent long-term trend in time series to specifically highlight any notable deviations</p></li>
<li><p>Let’s demonstrate using multiple years of AQI data</p></li>
</ul>
</section>
<section id="multiple-years-of-tucson-az-data" class="slide level2 smaller">
<h2>Multiple years of Tucson, AZ data</h2>
</section>
<section id="reading-multiple-files" class="slide level2 smaller">
<h2>Reading multiple files</h2>
<div id="fb84e764" class="cell" data-message="false" data-execution_count="21">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a><span class="co"># Define the list of URLs</span></span>
<span id="cb23-2"><a></a>tuc_files <span class="op">=</span> [</span>
<span id="cb23-3"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2022.csv"</span>,</span>
<span id="cb23-4"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2021.csv"</span>,</span>
<span id="cb23-5"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2020.csv"</span>,</span>
<span id="cb23-6"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2019.csv"</span>,</span>
<span id="cb23-7"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2018.csv"</span>,</span>
<span id="cb23-8"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/tucson/ad_aqi_tracker_data-2017.csv"</span></span>
<span id="cb23-9"><a></a>]</span>
<span id="cb23-10"><a></a></span>
<span id="cb23-11"><a></a><span class="co"># Initialize an empty dataframe</span></span>
<span id="cb23-12"><a></a>tuc <span class="op">=</span> pd.DataFrame()</span>
<span id="cb23-13"><a></a></span>
<span id="cb23-14"><a></a><span class="co"># Read and concatenate all data files</span></span>
<span id="cb23-15"><a></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> tuc_files:</span>
<span id="cb23-16"><a></a>    data <span class="op">=</span> pd.read_csv(<span class="bu">file</span>, na_values<span class="op">=</span>[<span class="st">"."</span>, <span class="st">""</span>])</span>
<span id="cb23-17"><a></a>    tuc <span class="op">=</span> pd.concat([tuc, data], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-18"><a></a></span>
<span id="cb23-19"><a></a><span class="co"># Clean column names using the clean_names function from the skimpy package</span></span>
<span id="cb23-20"><a></a>tuc <span class="op">=</span> clean_names(tuc).rename(columns<span class="op">=</span>{<span class="st">'_aqi_value'</span>: <span class="st">'aqi_value'</span>})</span>
<span id="cb23-21"><a></a></span>
<span id="cb23-22"><a></a><span class="co"># Clean and transform data</span></span>
<span id="cb23-23"><a></a>tuc[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(tuc[<span class="st">'date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%m/</span><span class="sc">%d</span><span class="st">/%Y'</span>)</span>
<span id="cb23-24"><a></a>tuc <span class="op">=</span> tuc.dropna(subset<span class="op">=</span>[<span class="st">'aqi_value'</span>])</span>
<span id="cb23-25"><a></a>tuc[<span class="st">'good_aqi'</span>] <span class="op">=</span> np.where(tuc[<span class="st">'aqi_value'</span>] <span class="op">&lt;=</span> <span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb23-26"><a></a>tuc <span class="op">=</span> tuc.sort_values(<span class="st">'date'</span>)</span>
<span id="cb23-27"><a></a>tuc[<span class="st">'cumsum_good_aqi'</span>] <span class="op">=</span> tuc[<span class="st">'good_aqi'</span>].cumsum()</span>
<span id="cb23-28"><a></a></span>
<span id="cb23-29"><a></a><span class="co"># Convert date to ordinal for regression</span></span>
<span id="cb23-30"><a></a>tuc[<span class="st">'date_ordinal'</span>] <span class="op">=</span> tuc[<span class="st">'date'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.toordinal())</span>
<span id="cb23-31"><a></a></span>
<span id="cb23-32"><a></a><span class="bu">print</span>(tuc.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           date  aqi_value main_pollutant     site_name      site_id source  \
1826 2017-01-01         38          Ozone  SAGUARO PARK  04-019-0021    AQS   
1827 2017-01-02         40          Ozone  SAGUARO PARK  04-019-0021    AQS   
1828 2017-01-03         38          Ozone  SAGUARO PARK  04-019-0021    AQS   
1829 2017-01-04         38          Ozone  SAGUARO PARK  04-019-0021    AQS   
1830 2017-01-05         32          Ozone  SAGUARO PARK  04-019-0021    AQS   

      20_year_high_2000_2019_  20_year_low_2000_2019_  \
1826                      115                      35   
1827                       57                      31   
1828                       67                      29   
1829                       55                      27   
1830                       52                      28   

      5_year_average_2015_2019_ date_of_20_year_high date_of_20_year_low  \
1826                       62.2           01/01/2018          01/01/2001   
1827                       43.2           01/02/2015          01/02/2016   
1828                       43.6           01/03/2015          01/03/2005   
1829                       40.4           01/04/2015          01/04/2008   
1830                       36.0           01/05/2013          01/05/2000   

      good_aqi  cumsum_good_aqi  date_ordinal  
1826         1                1        736330  
1827         1                2        736331  
1828         1                3        736332  
1829         1                4        736333  
1830         1                5        736334  </code></pre>
</div>
</div>
</section>
<section id="simple-linear-regression" class="slide level2">
<h2>Simple Linear Regression</h2>
<div id="19f8c0b4" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb25-2"><a></a></span>
<span id="cb25-3"><a></a><span class="co"># Fit linear regression for the trend line</span></span>
<span id="cb25-4"><a></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb25-5"><a></a>model.fit(tuc[[<span class="st">'date_ordinal'</span>]], tuc[<span class="st">'cumsum_good_aqi'</span>])</span>
<span id="cb25-6"><a></a>tuc[<span class="st">'fitted'</span>] <span class="op">=</span> model.predict(tuc[[<span class="st">'date_ordinal'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-trend-since-2017" class="slide level2 smaller">
<h2>Plot trend since 2017</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Plot</a></li><li><a href="#tabset-3-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div id="cell-tuc-3" class="cell" data-fig-asp="0.5" data-execution_count="23">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/tuc-3-output-1.png" id="tuc-3" width="753" height="527"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2">
<div id="5ca3a919" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a></a>sns.lineplot(data<span class="op">=</span>tuc, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'cumsum_good_aqi'</span>, color <span class="op">=</span> <span class="st">'black'</span>)</span>
<span id="cb26-2"><a></a>sns.lineplot(data<span class="op">=</span>tuc, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'fitted'</span>, color<span class="op">=</span><span class="st">'pink'</span>, label<span class="op">=</span><span class="st">'Trend Line'</span>)</span>
<span id="cb26-3"><a></a></span>
<span id="cb26-4"><a></a>plt.gca().xaxis.set_major_formatter(DateFormatter(<span class="st">"%Y"</span>))</span>
<span id="cb26-5"><a></a>plt.xlabel(<span class="va">None</span>)</span>
<span id="cb26-6"><a></a>plt.ylabel(<span class="st">"Number of days"</span>)</span>
<span id="cb26-7"><a></a>plt.title(<span class="st">"Cumulative number of good AQI days (AQI &lt; 50)</span><span class="ch">\n</span><span class="st">Tucson, AZ"</span>)</span>
<span id="cb26-8"><a></a>plt.figtext(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="st">'Source: EPA Daily Air Quality Tracker'</span>, ha<span class="op">=</span><span class="st">'center'</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb26-9"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="detrend" class="slide level2">
<h2>Detrend</h2>
<p>Step 1. Fit a simple linear regression</p>
<div id="a2e46f98" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a></a><span class="co"># Convert dates to ordinal for regression</span></span>
<span id="cb27-2"><a></a>tuc[<span class="st">'date_ordinal'</span>] <span class="op">=</span> tuc[<span class="st">'date'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.toordinal())</span>
<span id="cb27-3"><a></a></span>
<span id="cb27-4"><a></a><span class="co"># Fit linear regression</span></span>
<span id="cb27-5"><a></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb27-6"><a></a>model.fit(tuc[[<span class="st">'date_ordinal'</span>]], tuc[<span class="st">'cumsum_good_aqi'</span>])</span>
<span id="cb27-7"><a></a></span>
<span id="cb27-8"><a></a><span class="co"># Get fitted values</span></span>
<span id="cb27-9"><a></a>tuc[<span class="st">'fitted'</span>] <span class="op">=</span> model.predict(tuc[[<span class="st">'date_ordinal'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="detrend-1" class="slide level2">
<h2>Detrend</h2>
<p>Step 2. Divide the observed value of <code>cumsum_good_aqi</code> by the respective value in the long-term trend (i.e., <code>fitted</code>)</p>
<div id="3cc1c3bb" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a></a>tuc[<span class="st">'ratio'</span>] <span class="op">=</span> tuc[<span class="st">'cumsum_good_aqi'</span>] <span class="op">/</span> tuc[<span class="st">'fitted'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-detrended-data" class="slide level2 smaller">
<h2>Visualize detrended data</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Plot</a></li><li><a href="#tabset-4-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div id="cell-tuc-4" class="cell" data-fig-asp="0.5" data-execution_count="27">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/tuc-4-output-1.png" id="tuc-4" width="753" height="527"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2">
<div id="7689b9f8" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a></a>plt.axhline(y<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb29-2"><a></a>sns.lineplot(data<span class="op">=</span>tuc, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'ratio'</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb29-3"><a></a>plt.gca().xaxis.set_major_formatter(DateFormatter(<span class="st">"%Y"</span>))</span>
<span id="cb29-4"><a></a>plt.ylim([<span class="dv">0</span>, <span class="dv">20</span>])</span>
<span id="cb29-5"><a></a>plt.xlabel(<span class="va">None</span>)</span>
<span id="cb29-6"><a></a>plt.ylabel(<span class="st">"Number of days</span><span class="ch">\n</span><span class="st">(detrended)"</span>)</span>
<span id="cb29-7"><a></a>plt.title(<span class="st">"Cumulative number of good AQI days (AQI &lt; 50)</span><span class="ch">\n</span><span class="st">Tucson, AZ (2016-2022)"</span>)</span>
<span id="cb29-8"><a></a>plt.figtext(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="st">'Source: EPA Daily Air Quality Tracker'</span>, ha<span class="op">=</span><span class="st">'center'</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb29-9"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="air-quality-in-tucson" class="slide level2">
<h2>Air Quality in Tucson</h2>
<p><br><br></p>
<div class="hand">
<p>barely anything interesting happening!</p>
</div>
<div class="fragment">
<div class="hand">
<p>let’s look at data from somewhere with a bit more “interesting” air quality data…</p>
</div>
</div>
</section>
<section id="read-in-multiple-years-of-sf-data" class="slide level2 smaller">
<h2>Read in multiple years of SF data</h2>
<div id="8af918a3" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a><span class="co"># Define the list of URLs</span></span>
<span id="cb30-2"><a></a>sf_files <span class="op">=</span> [</span>
<span id="cb30-3"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/san-francisco/ad_aqi_tracker_data-2022.csv"</span>,</span>
<span id="cb30-4"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/san-francisco/ad_aqi_tracker_data-2021.csv"</span>,</span>
<span id="cb30-5"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/san-francisco/ad_aqi_tracker_data-2020.csv"</span>,</span>
<span id="cb30-6"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/san-francisco/ad_aqi_tracker_data-2019.csv"</span>,</span>
<span id="cb30-7"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/san-francisco/ad_aqi_tracker_data-2018.csv"</span>,</span>
<span id="cb30-8"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/san-francisco/ad_aqi_tracker_data-2017.csv"</span>,</span>
<span id="cb30-9"><a></a>    <span class="st">"https://raw.githubusercontent.com/Gchism94/GL-dataviz-lectures/main/slides/data/san-francisco/ad_aqi_tracker_data-2016.csv"</span></span>
<span id="cb30-10"><a></a>]</span>
<span id="cb30-11"><a></a></span>
<span id="cb30-12"><a></a><span class="co"># Initialize an empty dataframe</span></span>
<span id="cb30-13"><a></a>sf <span class="op">=</span> pd.DataFrame()</span>
<span id="cb30-14"><a></a></span>
<span id="cb30-15"><a></a><span class="co"># Read and concatenate all data files</span></span>
<span id="cb30-16"><a></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> sf_files:</span>
<span id="cb30-17"><a></a>    data <span class="op">=</span> pd.read_csv(<span class="bu">file</span>, na_values<span class="op">=</span>[<span class="st">"."</span>, <span class="st">""</span>])</span>
<span id="cb30-18"><a></a>    sf <span class="op">=</span> pd.concat([sf, data], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-19"><a></a></span>
<span id="cb30-20"><a></a><span class="co"># Clean column names using the clean_names function from the skimpy package</span></span>
<span id="cb30-21"><a></a>sf <span class="op">=</span> clean_names(sf).rename(columns<span class="op">=</span>{<span class="st">'_aqi_value'</span>: <span class="st">'aqi_value'</span>})</span>
<span id="cb30-22"><a></a></span>
<span id="cb30-23"><a></a><span class="co"># Clean and transform data</span></span>
<span id="cb30-24"><a></a>sf[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(sf[<span class="st">'date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%m/</span><span class="sc">%d</span><span class="st">/%Y'</span>)</span>
<span id="cb30-25"><a></a>sf <span class="op">=</span> sf.dropna(subset<span class="op">=</span>[<span class="st">'aqi_value'</span>])</span>
<span id="cb30-26"><a></a>sf[<span class="st">'good_aqi'</span>] <span class="op">=</span> np.where(sf[<span class="st">'aqi_value'</span>] <span class="op">&lt;=</span> <span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb30-27"><a></a>sf <span class="op">=</span> sf.sort_values(<span class="st">'date'</span>)</span>
<span id="cb30-28"><a></a>sf[<span class="st">'cumsum_good_aqi'</span>] <span class="op">=</span> sf[<span class="st">'good_aqi'</span>].cumsum()</span>
<span id="cb30-29"><a></a></span>
<span id="cb30-30"><a></a><span class="co"># Convert date to ordinal for regression</span></span>
<span id="cb30-31"><a></a>sf[<span class="st">'date_ordinal'</span>] <span class="op">=</span> sf[<span class="st">'date'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.toordinal())</span>
<span id="cb30-32"><a></a></span>
<span id="cb30-33"><a></a><span class="bu">print</span>(sf.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           date  aqi_value main_pollutant      site_name      site_id source  \
2191 2016-01-01         32          PM2.5  Durham Armory  37-063-0015    AQS   
2192 2016-01-02         37          PM2.5  Durham Armory  37-063-0015    AQS   
2193 2016-01-03         45          PM2.5  Durham Armory  37-063-0015    AQS   
2194 2016-01-04         33          PM2.5  Durham Armory  37-063-0015    AQS   
2195 2016-01-05         27          PM2.5  Durham Armory  37-063-0015    AQS   

      20_year_high_2000_2019_  20_year_low_2000_2019_  \
2191                      111                      10   
2192                       76                       8   
2193                       66                      14   
2194                       61                       9   
2195                       83                       8   

      5_year_average_2015_2019_ date_of_20_year_high date_of_20_year_low  \
2191                       39.2           01/01/2000          01/01/2007   
2192                       36.8           01/02/2005          01/02/2012   
2193                       38.2           01/03/2004          01/03/2012   
2194                       30.4           01/04/2008          01/04/2007   
2195                       26.0           01/05/2001          01/05/2015   

      good_aqi  cumsum_good_aqi  date_ordinal  
2191         1                1        735964  
2192         1                2        735965  
2193         1                3        735966  
2194         1                4        735967  
2195         1                5        735968  </code></pre>
</div>
</div>
</section>
<section id="simple-linear-regression-1" class="slide level2">
<h2>Simple Linear Regression</h2>
<div id="6b5c138e" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a></a><span class="co"># Fit linear regression for the trend line</span></span>
<span id="cb32-2"><a></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb32-3"><a></a>model.fit(sf[[<span class="st">'date_ordinal'</span>]], sf[<span class="st">'cumsum_good_aqi'</span>])</span>
<span id="cb32-4"><a></a>sf[<span class="st">'fitted'</span>] <span class="op">=</span> model.predict(sf[[<span class="st">'date_ordinal'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-trend-since-2016" class="slide level2 smaller">
<h2>Plot trend since 2016</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Plot</a></li><li><a href="#tabset-5-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div id="cell-sf-1" class="cell" data-fig-asp="0.5" data-execution_count="31">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/sf-1-output-1.png" id="sf-1" width="753" height="527"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2">
<div id="cda75c75" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a></a>sns.lineplot(data<span class="op">=</span>sf, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'cumsum_good_aqi'</span>, color <span class="op">=</span> <span class="st">'black'</span>)</span>
<span id="cb33-2"><a></a>sns.lineplot(data<span class="op">=</span>sf, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'fitted'</span>, color<span class="op">=</span><span class="st">'pink'</span>, label<span class="op">=</span><span class="st">'Trend Line'</span>)</span>
<span id="cb33-3"><a></a></span>
<span id="cb33-4"><a></a>plt.gca().xaxis.set_major_formatter(DateFormatter(<span class="st">"%Y"</span>))</span>
<span id="cb33-5"><a></a>plt.xlabel(<span class="va">None</span>)</span>
<span id="cb33-6"><a></a>plt.ylabel(<span class="st">"Number of days"</span>)</span>
<span id="cb33-7"><a></a>plt.title(<span class="st">"Cumulative number of good AQI days (AQI &lt; 50)</span><span class="ch">\n</span><span class="st">San Francisco, CA"</span>)</span>
<span id="cb33-8"><a></a>plt.figtext(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="st">'Source: EPA Daily Air Quality Tracker'</span>, ha<span class="op">=</span><span class="st">'center'</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb33-9"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="detrend-2" class="slide level2">
<h2>Detrend</h2>
<p>Step 1. Fit a simple linear regression</p>
<div id="6e642516" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a></a><span class="co"># Convert dates to ordinal for regression</span></span>
<span id="cb34-2"><a></a>sf[<span class="st">'date_ordinal'</span>] <span class="op">=</span> sf[<span class="st">'date'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.toordinal())</span>
<span id="cb34-3"><a></a></span>
<span id="cb34-4"><a></a><span class="co"># Fit linear regression</span></span>
<span id="cb34-5"><a></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb34-6"><a></a>model.fit(sf[[<span class="st">'date_ordinal'</span>]], sf[<span class="st">'cumsum_good_aqi'</span>])</span>
<span id="cb34-7"><a></a></span>
<span id="cb34-8"><a></a><span class="co"># Get fitted values</span></span>
<span id="cb34-9"><a></a>sf[<span class="st">'fitted'</span>] <span class="op">=</span> model.predict(sf[[<span class="st">'date_ordinal'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="detrend-3" class="slide level2">
<h2>Detrend</h2>
<p>Step 2. Divide the observed value of <code>cumsum_good_aqi</code> by the respective value in the long-term trend (i.e., <code>fitted</code>)</p>
<div id="702a38bb" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a></a>sf[<span class="st">'ratio'</span>] <span class="op">=</span> sf[<span class="st">'cumsum_good_aqi'</span>] <span class="op">/</span> sf[<span class="st">'fitted'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-detrended-data-1" class="slide level2 smaller">
<h2>Visualize detrended data</h2>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Plot</a></li><li><a href="#tabset-6-2">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div id="cell-sf-2" class="cell" data-fig-asp="0.5" data-execution_count="35">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/sf-2-output-1.png" id="sf-2" width="753" height="527"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2">
<div id="bd5e3c75" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a></a>plt.axhline(y<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb36-2"><a></a>sns.lineplot(data<span class="op">=</span>sf, x<span class="op">=</span><span class="st">'date'</span>, y<span class="op">=</span><span class="st">'ratio'</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb36-3"><a></a>plt.gca().xaxis.set_major_formatter(DateFormatter(<span class="st">"%Y"</span>))</span>
<span id="cb36-4"><a></a>plt.xlabel(<span class="va">None</span>)</span>
<span id="cb36-5"><a></a>plt.ylabel(<span class="st">"Number of days</span><span class="ch">\n</span><span class="st">(detrended)"</span>)</span>
<span id="cb36-6"><a></a>plt.title(<span class="st">"Cumulative number of good AQI days (AQI &lt; 50)</span><span class="ch">\n</span><span class="st">San Francisco, CA (2016-2022)"</span>)</span>
<span id="cb36-7"><a></a>plt.figtext(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="st">'Source: EPA Daily Air Quality Tracker'</span>, ha<span class="op">=</span><span class="st">'center'</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb36-8"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="detrending-2" class="slide level2">
<h2>Detrending</h2>
<ul>
<li><p>In step 2 we fit a very simple model</p></li>
<li><p>Depending on the complexity you’re trying to capture you might choose to fit a much more complex model</p></li>
<li><p>You can also decompose the trend into multiple trends, e.g.&nbsp;monthly, long-term, seasonal, etc.</p></li>
</ul>
</section></section>
<section>
<section id="highlighting" class="title-slide slide level1 center">
<h1>Highlighting</h1>

</section>
<section id="data-prep" class="slide level2 smaller">
<h2>Data prep</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div id="2f97c209" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb37-2"><a></a></span>
<span id="cb37-3"><a></a>sf[<span class="st">'year'</span>] <span class="op">=</span> sf[<span class="st">'date'</span>].dt.year</span>
<span id="cb37-4"><a></a>sf[<span class="st">'day_of_year'</span>] <span class="op">=</span> sf[<span class="st">'date'</span>].dt.dayofyear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div id="2e274a63" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a></a><span class="co"># check</span></span>
<span id="cb38-2"><a></a><span class="bu">print</span>(sf[sf[<span class="st">'day_of_year'</span>] <span class="op">&lt;</span> <span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           date  aqi_value main_pollutant              site_name      site_id  \
2191 2016-01-01         32          PM2.5          Durham Armory  37-063-0015   
2192 2016-01-02         37          PM2.5          Durham Armory  37-063-0015   
1826 2017-01-01         55          PM2.5              San Pablo  06-013-1004   
1827 2017-01-02         36          Ozone         Patterson Pass  06-001-2005   
1461 2018-01-01         87          PM2.5           Oakland West  06-001-0011   
1462 2018-01-02         95          PM2.5           Oakland West  06-001-0011   
1096 2019-01-01         33          PM2.5           Redwood City  06-081-1001   
1097 2019-01-02         50          PM2.5              Livermore  06-001-0007   
730  2020-01-01         53          PM2.5                Oakland  06-001-0009   
731  2020-01-02         43          PM2.5  Berkeley Aquatic Park  06-001-0013   
365  2021-01-01         79          PM2.5           Oakland West  06-001-0011   
366  2021-01-02         57          PM2.5  Pleasanton - Owens Ct  06-001-0015   
0    2022-01-01         53          PM2.5                Oakland  06-001-0009   
1    2022-01-02         55          PM2.5              Livermore  06-001-0007   

     source  20_year_high_2000_2019_  20_year_low_2000_2019_  \
2191    AQS                      111                      10   
2192    AQS                       76                       8   
1826    AQS                      162                      33   
1827    AQS                      140                      21   
1461    AQS                      162                      33   
1462    AQS                      140                      21   
1096    AQS                      162                      33   
1097    AQS                      140                      21   
730     AQS                      162                      33   
731     AQS                      140                      21   
365     AQS                      162                      33   
366     AQS                      140                      21   
0       AQS                      162                      33   
1       AQS                      140                      21   

      5_year_average_2015_2019_ date_of_20_year_high date_of_20_year_low  \
2191                       39.2           01/01/2000          01/01/2007   
2192                       36.8           01/02/2005          01/02/2012   
1826                       60.6           01/01/2001          01/01/2019   
1827                       63.2           01/02/2001          01/02/2002   
1461                       60.6           01/01/2001          01/01/2019   
1462                       63.2           01/02/2001          01/02/2002   
1096                       60.6           01/01/2001          01/01/2019   
1097                       63.2           01/02/2001          01/02/2002   
730                        60.6           01/01/2001          01/01/2019   
731                        63.2           01/02/2001          01/02/2002   
365                        60.6           01/01/2001          01/01/2019   
366                        63.2           01/02/2001          01/02/2002   
0                          60.6           01/01/2001          01/01/2019   
1                          63.2           01/02/2001          01/02/2002   

      good_aqi  cumsum_good_aqi  date_ordinal       fitted     ratio  year  \
2191         1                1        735964    22.288160  0.044867  2016   
2192         1                2        735965    22.861827  0.087482  2016   
1826         0              267        736330   232.250591  1.149620  2017   
1827         1              268        736331   232.824259  1.151083  2017   
1461         0              440        736695   441.639355  0.996288  2018   
1462         0              440        736696   442.213023  0.994996  2018   
1096         1              589        737060   651.028119  0.904723  2019   
1097         1              590        737061   651.601787  0.905461  2019   
730          0              843        737425   860.416883  0.979758  2020   
731          1              844        737426   860.990550  0.980266  2020   
365          0             1070        737791  1070.379314  0.999646  2021   
366          0             1070        737792  1070.952982  0.999110  2021   
0            0             1282        738156  1279.768078  1.001744  2022   
1            0             1282        738157  1280.341746  1.001295  2022   

      day_of_year  
2191            1  
2192            2  
1826            1  
1827            2  
1461            1  
1462            2  
1096            1  
1097            2  
730             1  
731             2  
365             1  
366             2  
0               1  
1               2  </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="plot-aqi-over-years" class="slide level2 smaller">
<h2>Plot AQI over years</h2>
<div id="1cd4d13c" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a></a>sns.lineplot(data<span class="op">=</span>sf, x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, hue<span class="op">=</span><span class="st">'year'</span>, palette<span class="op">=</span><span class="st">'tab10'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-2"><a></a>plt.xlabel(<span class="st">'Day of year'</span>)</span>
<span id="cb40-3"><a></a>plt.ylabel(<span class="st">'AQI value'</span>)</span>
<span id="cb40-4"><a></a>plt.title(<span class="st">'AQI levels in San Francisco (2016 - 2022)'</span>)</span>
<span id="cb40-5"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-40-output-1.png" width="753" height="459"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="highlight-specific-year-2016" class="slide level2 smaller">
<h2>Highlight specific year (2016)</h2>
<div id="6c2e6fd2" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a></a><span class="co"># Highlight the year 2016</span></span>
<span id="cb41-2"><a></a>sns.lineplot(data<span class="op">=</span>sf, x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb41-3"><a></a>sns.lineplot(data<span class="op">=</span>sf[sf[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2016</span>], x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb41-4"><a></a>plt.xlabel(<span class="st">'Day of year'</span>)</span>
<span id="cb41-5"><a></a>plt.ylabel(<span class="st">'AQI value'</span>)</span>
<span id="cb41-6"><a></a>plt.title(<span class="st">'AQI levels in SF in 2016</span><span class="ch">\n</span><span class="st">Versus all years 2016 - 2022'</span>)</span>
<span id="cb41-7"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-41-output-1.png" width="753" height="459"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="highlight-specific-year-2017" class="slide level2 smaller">
<h2>Highlight specific year (2017)</h2>
<div id="729f95f7" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a></a><span class="co"># Highlight the year 2017</span></span>
<span id="cb42-2"><a></a>sns.lineplot(data<span class="op">=</span>sf, x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb42-3"><a></a>sns.lineplot(data<span class="op">=</span>sf[sf[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2017</span>], x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb42-4"><a></a>plt.xlabel(<span class="st">'Day of year'</span>)</span>
<span id="cb42-5"><a></a>plt.ylabel(<span class="st">'AQI value'</span>)</span>
<span id="cb42-6"><a></a>plt.title(<span class="st">'AQI levels in SF in 2017</span><span class="ch">\n</span><span class="st">Versus all years 2016 - 2022'</span>)</span>
<span id="cb42-7"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-42-output-1.png" width="753" height="459"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="highlight-specific-year-2018" class="slide level2 smaller">
<h2>Highlight specific year (2018)</h2>
<div id="88021ff6" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a></a><span class="co"># Highlight the year 2018</span></span>
<span id="cb43-2"><a></a>sns.lineplot(data<span class="op">=</span>sf, x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb43-3"><a></a>sns.lineplot(data<span class="op">=</span>sf[sf[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2018</span>], x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb43-4"><a></a>plt.xlabel(<span class="st">'Day of year'</span>)</span>
<span id="cb43-5"><a></a>plt.ylabel(<span class="st">'AQI value'</span>)</span>
<span id="cb43-6"><a></a>plt.title(<span class="st">'AQI levels in SF in 2018</span><span class="ch">\n</span><span class="st">Versus all years 2016 - 2022'</span>)</span>
<span id="cb43-7"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-43-output-1.png" width="753" height="459"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="highlight-any-year" class="slide level2 smaller">
<h2>Highlight any year</h2>
<div id="a2758e04" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a></a><span class="co"># Function to highlight a specific year</span></span>
<span id="cb44-2"><a></a><span class="kw">def</span> highlight_year(year_to_highlight):</span>
<span id="cb44-3"><a></a>    sns.lineplot(data<span class="op">=</span>sf, x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb44-4"><a></a>    sns.lineplot(data<span class="op">=</span>sf[sf[<span class="st">'year'</span>] <span class="op">==</span> year_to_highlight], x<span class="op">=</span><span class="st">'day_of_year'</span>, y<span class="op">=</span><span class="st">'aqi_value'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb44-5"><a></a>    plt.xlabel(<span class="st">'Day of year'</span>)</span>
<span id="cb44-6"><a></a>    plt.ylabel(<span class="st">'AQI value'</span>)</span>
<span id="cb44-7"><a></a>    plt.title(<span class="ss">f'AQI levels in SF in </span><span class="sc">{</span>year_to_highlight<span class="sc">}</span><span class="ch">\n</span><span class="ss">Versus all years 2016 - 2022'</span>)</span>
<span id="cb44-8"><a></a>    plt.show()</span>
<span id="cb44-9"><a></a></span>
<span id="cb44-10"><a></a><span class="co"># Highlight any year</span></span>
<span id="cb44-11"><a></a>highlight_year(<span class="dv">2018</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="week4_files/figure-revealjs/cell-44-output-1.png" width="753" height="459"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section id="thank-you" class="title-slide slide level1 center">
<h1>Thank you 😊</h1>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="https://gchism94.github.io/GL-dataviz-lectures">🔗 GL-dataviz-lectures</a></p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/gchism94\.github\.io\/GL-dataviz-lectures");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>